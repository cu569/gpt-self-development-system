<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>리더 리마 승인 상황판</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    body { font-family:sans-serif; background:#f8f8ff; margin:2em;}
    .box { max-width:430px; margin:auto; background:white; border-radius:18px; box-shadow:0 3px 10px #bbb; padding:2em;}
    #leaderStatus, #log, #fpStatus { background:#e7f3ff; border-radius:10px; padding:1em; min-height:40px; margin-bottom:1em;}
    #approveBtn { width:100%; padding:0.7em; border-radius:9px; margin-bottom:1em; font-size:1.1em;}
  </style>
</head>
<body>
  <div class="box">
    <h2>리더 리마 승인 상황판</h2>
    <div id="leaderStatus"></div>
    <button id="approveBtn" onclick="requestFingerprint()" style="display:none;">추가 리더 리마 승인(지문인증)</button>
    <div id="fpStatus"></div>
    <div id="log"></div>
    <hr>
    <h3>채팅/알림(예시)</h3>
    <div id="chatlog"></div>
  </div>
  <script>
    // 상태/상황 변수
    let leaderCount = 10; // 기본 10개까지 자동
    let logList = [];

    function updateStatus() {
      document.getElementById('leaderStatus').innerText = `현재 리더 리마: ${leaderCount}개`;
      if(leaderCount >= 10) document.getElementById('approveBtn').style.display = 'block';
      else document.getElementById('approveBtn').style.display = 'none';
    }

    // 실제 WebAuthn 연동 필요(아래는 시뮬레이션)
    async function requestFingerprint() {
      document.getElementById('fpStatus').innerText = "지문 인증 대기중...";
      setTimeout(()=>{
        // 실제 구현: navigator.credentials.get({publicKey}) 연동 (WebAuthn)
        let success = confirm("지문 인증 성공 처리(예시)\n[실제 배포시 WebAuthn/모바일 생체인증으로 교체]");
        if(success) {
          leaderCount++;
          updateStatus();
          let msg = `[승인] 지문 인증 성공, ${leaderCount}번째 리더 리마 생성!`;
          document.getElementById('fpStatus').innerText = msg;
          logList.push(msg);
        } else {
          let msg = "[실패] 지문 인증 거부/실패";
          document.getElementById('fpStatus').innerText = msg;
          logList.push(msg);
        }
        updateLog();
      }, 1200);
    }
    function updateLog() {
      document.getElementById('log').innerHTML = "<b>로그 이력</b><br>" + logList.slice(-6).reverse().join("<br>");
      document.getElementById('chatlog').innerHTML = 
        `<div>[알림] 리더 리마 10개 초과 추가 생성 승인 필요. 지문 인증 요청중...</div>
        <div>[상황] 관리자 승인/거부 모두 기록됩니다.</div>`;
    }
    // 최초상태
    updateStatus(); updateLog();
  </script>
</body>
</html>
