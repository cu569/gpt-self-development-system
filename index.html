<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìê°€í•™ìŠµ AI ì½”ì¹˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            height: 100vh;
        }
        
        .panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
        }
        
        .panel h2 {
            margin-bottom: 20px;
            color: #333;
            text-align: center;
            font-size: 1.5em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        /* ì™¼ìª½ íŒ¨ë„ - ì‹¤ìŠµ/ì‘ì—… ì˜ì—­ */
        .workspace {
            position: relative;
        }
        
        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .upload-area:hover {
            border-color: #764ba2;
            background: #f8f9fa;
        }
        
        .upload-area.dragover {
            border-color: #28a745;
            background: #e8f5e8;
        }
        
        #imagePreview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            margin: 10px 0;
            display: none;
        }
        
        .analysis-result {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #17a2b8;
        }
        
        .user-input {
            margin-top: 20px;
        }
        
        .user-input textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            resize: vertical;
            min-height: 80px;
            font-size: 16px;
        }
        
        .user-input textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        /* ì˜¤ë¥¸ìª½ íŒ¨ë„ - ì½”ì¹˜ ì˜ì—­ */
        .coach-panel {
            position: relative;
        }
        
        .coach-tabs {
            display: flex;
            margin-bottom: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
        }
        
        .coach-tab {
            flex: 1;
            padding: 10px 15px;
            background: none;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .coach-tab.active {
            background: #667eea;
            color: white;
        }
        
        .coach-content {
            flex: 1;
            overflow-y: auto;
            display: none;
        }
        
        .coach-content.active {
            display: block;
        }
        
        .chat-container {
            height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            background: #fafafa;
            margin-bottom: 15px;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 10px;
            max-width: 80%;
            line-height: 1.5;
        }
        
        .message.user {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            margin-left: auto;
            text-align: right;
        }
        
        .message.ai {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
        }
        
        .message.coach {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
        }
        
        .learning-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }
        
        .progress-section {
            margin: 20px 0;
        }
        
        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .analysis-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 12px;
            margin: 8px 0;
            border-left: 4px solid #667eea;
        }
        
        .coach-suggestion {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border-left: 4px solid #ff9800;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .typing-indicator {
            color: #666;
            font-style: italic;
            animation: dots 1.5s infinite;
        }
        
        @keyframes dots {
            0%, 20% { opacity: 0; }
            40% { opacity: 0.5; }
            60% { opacity: 1; }
            80%, 100% { opacity: 0.5; }
        }
        
        .voice-controls {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .voice-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .voice-btn.recording {
            background: #ff0000;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ì™¼ìª½ íŒ¨ë„: ì‹¤ìŠµ/ì‘ì—… ì˜ì—­ -->
        <div class="panel workspace">
            <h2>ğŸ¨ ì‹¤ìŠµ ì‘ì—… ì˜ì—­</h2>
            
            <div class="upload-area" id="uploadArea">
                <div>
                    <p>ğŸ“ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</p>
                    <p>ì´ë¯¸ì§€, ë¬¸ì„œ, ì˜¤ë””ì˜¤ íŒŒì¼ ì§€ì›</p>
                </div>
                <input type="file" id="fileInput" style="display: none;" accept="image/*,audio/*,.txt,.pdf,.docx">
                <img id="imagePreview" alt="ì—…ë¡œë“œëœ ì´ë¯¸ì§€">
            </div>
            
            <div id="analysisResults"></div>
            
            <div class="user-input">
                <div class="voice-controls">
                    <button class="voice-btn" id="voiceBtn" title="ìŒì„± ì…ë ¥">ğŸ¤</button>
                    <button class="btn btn-secondary" onclick="clearWorkspace()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
                </div>
                <textarea id="userInput" placeholder="ì‘ì—…ì— ëŒ€í•œ ì§ˆë¬¸ì´ë‚˜ ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="processInput()">ğŸ’¬ ë¶„ì„ ìš”ì²­</button>
                    <button class="btn btn-success" onclick="getCoachFeedback()">ğŸ¯ ì½”ì¹˜ ì¡°ì–¸</button>
                </div>
            </div>
        </div>
        
        <!-- ì˜¤ë¥¸ìª½ íŒ¨ë„: AI ì½”ì¹˜ ì˜ì—­ -->
        <div class="panel coach-panel">
            <h2>ğŸ¤– AI ë©€í‹° ì½”ì¹˜</h2>
            
            <div class="coach-tabs">
                <button class="coach-tab active" onclick="switchTab('chat')">ğŸ’¬ ì‹¤ì‹œê°„ ì½”ì¹˜</button>
                <button class="coach-tab" onclick="switchTab('progress')">ğŸ“Š í•™ìŠµ ì§„ë„</button>
                <button class="coach-tab" onclick="switchTab('analysis')">ğŸ” ë¶„ì„ íˆìŠ¤í† ë¦¬</button>
            </div>
            
            <!-- ì‹¤ì‹œê°„ ì½”ì¹˜ ì±„íŒ… -->
            <div class="coach-content active" id="chatContent">
                <div class="chat-container" id="chatContainer">
                    <div class="message ai">
                        <strong>GPT ì½”ì¹˜:</strong> ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” ì—¬ëŸ¬ë¶„ì˜ í•™ìŠµì„ ë„ì™€ë“œë¦¬ëŠ” AI ì½”ì¹˜ì…ë‹ˆë‹¤. ğŸš€<br><br>
                        <strong>Claude ì½”ì¹˜:</strong> í•¨ê»˜ ì‘ì—…í•˜ë©° ì‹¤ì‹œê°„ìœ¼ë¡œ í”¼ë“œë°±ì„ ë“œë¦´ê²Œìš”! ğŸ’¡<br><br>
                        ë¬´ì—‡ì´ë“  ì—…ë¡œë“œí•˜ê±°ë‚˜ ì§ˆë¬¸í•´ë³´ì„¸ìš”!
                    </div>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="chatInput" placeholder="ì½”ì¹˜ì—ê²Œ ì§ˆë¬¸í•˜ì„¸ìš”..." style="flex: 1; padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
                    <button class="btn btn-primary" onclick="sendChatMessage()">ì „ì†¡</button>
                </div>
            </div>
            
            <!-- í•™ìŠµ ì§„ë„ -->
            <div class="coach-content" id="progressContent">
                <div class="learning-stats">
                    <div class="stat-card">
                        <span class="stat-number" id="sessionCount">0</span>
                        <span>í•™ìŠµ ì„¸ì…˜</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="improvementScore">0%</span>
                        <span>í–¥ìƒë„</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="feedbackCount">0</span>
                        <span>ë°›ì€ í”¼ë“œë°±</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="skillLevel">ì´ˆê¸‰</span>
                        <span>í˜„ì¬ ë ˆë²¨</span>
                    </div>
                </div>
                
                <div class="progress-section">
                    <h4>ğŸ“ˆ ì „ì²´ í•™ìŠµ ì§„ë„</h4>
                    <div class="progress-bar">
                        <div class="progress-fill" id="overallProgress" style="width: 15%"></div>
                    </div>
                    <p>15% - ê¸°ì´ˆ ë‹¨ê³„ë¥¼ ë§ˆìŠ¤í„°í•˜ê³  ìˆì–´ìš”!</p>
                    
                    <h4>ğŸ¯ ì£¼ìš” ìŠ¤í‚¬ ë°œì „ë„</h4>
                    <div style="margin: 10px 0;">
                        <p>ì°½ì˜ì„±: <span style="float: right;">â­â­â­â˜†â˜†</span></p>
                        <p>ë¶„ì„ë ¥: <span style="float: right;">â­â­â˜†â˜†â˜†</span></p>
                        <p>ì‹¤í–‰ë ¥: <span style="float: right;">â­â­â­â­â˜†</span></p>
                    </div>
                </div>
                
                <div class="coach-suggestion">
                    <h4>ğŸ’¡ ë‹¤ìŒ ë‹¨ê³„ ì¶”ì²œ</h4>
                    <p>â€¢ ë” ë³µì¡í•œ í”„ë¡œì íŠ¸ì— ë„ì „í•´ë³´ì„¸ìš”</p>
                    <p>â€¢ ë‹¤ì–‘í•œ ìŠ¤íƒ€ì¼ì˜ ì‘ì—…ì„ ì‹œë„í•´ë³´ì„¸ìš”</p>
                    <p>â€¢ í”¼ë“œë°±ì„ ë°”íƒ•ìœ¼ë¡œ ê°œì„ ì ì„ ì ìš©í•´ë³´ì„¸ìš”</p>
                </div>
            </div>
            
            <!-- ë¶„ì„ íˆìŠ¤í† ë¦¬ -->
            <div class="coach-content" id="analysisContent">
                <div id="historyList">
                    <p>ì•„ì§ ë¶„ì„ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ì§ˆë¬¸ì„ í•´ë³´ì„¸ìš”!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let learningData = {
            sessions: 0,
            feedbacks: [],
            improvements: [],
            analysisHistory: [],
            userPreferences: {},
            skillProgress: {
                creativity: 3,
                analysis: 2,
                execution: 4
            }
        };
        
        let isListening = false;
        let recognition = null;
        
        // ìŒì„± ì¸ì‹ ì´ˆê¸°í™”
        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.lang = 'ko-KR';
                recognition.continuous = false;
                recognition.interimResults = false;
                
                recognition.onstart = function() {
                    isListening = true;
                    document.getElementById('voiceBtn').classList.add('recording');
                };
                
                recognition.onresult = function(event) {
                    const result = event.results[0][0].transcript;
                    document.getElementById('userInput').value = result;
                    processInput();
                };
                
                recognition.onerror = function(event) {
                    console.error('Speech recognition error:', event.error);
                    stopListening();
                };
                
                recognition.onend = function() {
                    stopListening();
                };
                
                return true;
            }
            return false;
        }
        
        function toggleVoice() {
            if (!recognition) {
                alert('ìŒì„± ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €ì…ë‹ˆë‹¤.');
                return;
            }
            
            if (isListening) {
                recognition.stop();
            } else {
                recognition.start();
            }
        }
        
        function stopListening() {
            isListening = false;
            document.getElementById('voiceBtn').classList.remove('recording');
        }
        
        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        function setupFileUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const imagePreview = document.getElementById('imagePreview');
            
            uploadArea.addEventListener('click', () => fileInput.click());
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });
            
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0]);
                }
            });
        }
        
        function handleFile(file) {
            const reader = new FileReader();
            const imagePreview = document.getElementById('imagePreview');
            
            if (file.type.startsWith('image/')) {
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'block';
                    analyzeImage(e.target.result);
                };
                reader.readAsDataURL(file);
            } else {
                // ë‹¤ë¥¸ íŒŒì¼ íƒ€ì… ì²˜ë¦¬
                analyzeFile(file);
            }
        }
        
        function analyzeImage(imageSrc) {
            const analysisResults = document.getElementById('analysisResults');
            
            // ì‹¤ì œë¡œëŠ” AI ëª¨ë¸ë¡œ ë¶„ì„í•˜ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” ì‹œë®¬ë ˆì´ì…˜
            const analysis = {
                colors: ['#FF6B6B', '#4ECDC4', '#45B7D1'],
                objects: ['person', 'background', 'lighting'],
                style: 'modern',
                quality: 'good',
                improvements: [
                    'ìƒ‰ìƒ ëŒ€ë¹„ë¥¼ ë†’ì—¬ë³´ì„¸ìš”',
                    'êµ¬ë„ë¥¼ ë” ì—­ë™ì ìœ¼ë¡œ ë§Œë“¤ì–´ë³´ì„¸ìš”',
                    'ì¡°ëª…ì„ ë” ë°ê²Œ ì¡°ì •í•´ë³´ì„¸ìš”'
                ]
            };
            
            analysisResults.innerHTML = `
                <div class="analysis-result">
                    <h4>ğŸ” ì´ë¯¸ì§€ ìë™ ë¶„ì„ ê²°ê³¼</h4>
                    <div class="analysis-item">
                        <strong>ì£¼ìš” ìƒ‰ìƒ:</strong> ${analysis.colors.map(color => `<span style="background: ${color}; padding: 2px 8px; border-radius: 3px; color: white; margin: 0 2px;">${color}</span>`).join('')}
                    </div>
                    <div class="analysis-item">
                        <strong>ê°ì§€ëœ ê°ì²´:</strong> ${analysis.objects.join(', ')}
                    </div>
                    <div class="analysis-item">
                        <strong>ìŠ¤íƒ€ì¼:</strong> ${analysis.style}
                    </div>
                    <div class="analysis-item">
                        <strong>í’ˆì§ˆ í‰ê°€:</strong> ${analysis.quality}
                    </div>
                </div>
            `;
            
            // ìë™ìœ¼ë¡œ ì½”ì¹˜ í”¼ë“œë°± ìƒì„±
            setTimeout(() => {
                generateCoachFeedback(analysis);
            }, 1000);
            
            // íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
            addToHistory('image_analysis', analysis);
        }
        
        function analyzeFile(file) {
            const analysisResults = document.getElementById('analysisResults');
            
            analysisResults.innerHTML = `
                <div class="analysis-result">
                    <h4>ğŸ“„ íŒŒì¼ ì •ë³´</h4>
                    <div class="analysis-item">
                        <strong>íŒŒì¼ëª…:</strong> ${file.name}
                    </div>
                    <div class="analysis-item">
                        <strong>í¬ê¸°:</strong> ${(file.size / 1024 / 1024).toFixed(2)} MB
                    </div>
                    <div class="analysis-item">
                        <strong>íƒ€ì…:</strong> ${file.type || 'ì•Œ ìˆ˜ ì—†ìŒ'}
                    </div>
                </div>
            `;
            
            addToHistory('file_upload', { name: file.name, size: file.size, type: file.type });
        }
        
        function processInput() {
            const userInput = document.getElementById('userInput').value;
            if (!userInput.trim()) return;
            
            // ì‚¬ìš©ì ì…ë ¥ ë¶„ì„
            const analysis = analyzeUserInput(userInput);
            
            // ê²°ê³¼ í‘œì‹œ
            const analysisResults = document.getElementById('analysisResults');
            analysisResults.innerHTML = `
                <div class="analysis-result">
                    <h4>ğŸ’­ ì…ë ¥ ë¶„ì„ ê²°ê³¼</h4>
                    <div class="analysis-item">
                        <strong>ì£¼ì œ:</strong> ${analysis.topic}
                    </div>
                    <div class="analysis-item">
                        <strong>ì˜ë„:</strong> ${analysis.intent}
                    </div>
                    <div class="analysis-item">
                        <strong>ê°ì •:</strong> ${analysis.emotion}
                    </div>
                </div>
            `;
            
            // ì½”ì¹˜ ì‘ë‹µ ìƒì„±
            generateTextCoachResponse(userInput, analysis);
            
            // íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
            addToHistory('text_input', { input: userInput, analysis: analysis });
            
            // ì…ë ¥ì°½ ì´ˆê¸°í™”
            document.getElementById('userInput').value = '';
        }
        
        function analyzeUserInput(text) {
            // ê°„ë‹¨í•œ í…ìŠ¤íŠ¸ ë¶„ì„ ì‹œë®¬ë ˆì´ì…˜
            const keywords = {
                'ê·¸ë¦¼': 'art',
                'ìƒ‰ìƒ': 'color',
                'ë””ìì¸': 'design',
                'ê°œì„ ': 'improvement',
                'ë„ì›€': 'help',
                'ì§ˆë¬¸': 'question'
            };
            
            let topic = 'general';
            for (const [key, value] of Object.entries(keywords)) {
                if (text.includes(key)) {
                    topic = value;
                    break;
                }
            }
            
            const intent = text.includes('?') ? 'question' : 
                          text.includes('ë„ì™€') ? 'help_request' : 
                          text.includes('ì–´ë–»ê²Œ') ? 'how_to' : 'statement';
            
            const emotion = text.includes('ì¢‹') ? 'positive' :
                           text.includes('ë‚˜ì˜') || text.includes('í˜ë“¤') ? 'negative' : 'neutral';
            
            return { topic, intent, emotion };
        }
        
        function generateCoachFeedback(analysis) {
            const chatContainer = document.getElementById('chatContainer');
            
            const gptFeedback = `
                <div class="message ai">
                    <strong>GPT ì½”ì¹˜:</strong> ë¶„ì„ ê²°ê³¼ë¥¼ ë³´ë‹ˆ ì •ë§ í¥ë¯¸ë¡œìš´ ì‘í’ˆì´ë„¤ìš”! ğŸ¨<br><br>
                    <strong>ê°•ì :</strong><br>
                    â€¢ ìƒ‰ìƒ ì„ íƒì´ ì¡°í™”ë¡­ìŠµë‹ˆë‹¤<br>
                    â€¢ ì „ì²´ì ì¸ êµ¬ì„±ì´ ì•ˆì •ì ì´ì—ìš”<br><br>
                    <strong>ê°œì„  ì œì•ˆ:</strong><br>
                    â€¢ ${analysis.improvements ? analysis.improvements[0] : 'ë” ëŒ€ë‹´í•œ ìƒ‰ìƒ ì‹œë„í•´ë³´ì„¸ìš”'}<br>
                    â€¢ ì„¸ë¶€ ë””í…Œì¼ì„ ë” í’ë¶€í•˜ê²Œ ë§Œë“¤ì–´ë³´ì„¸ìš”
                </div>
            `;
            
            const claudeFeedback = `
                <div class="message coach">
                    <strong>Claude ì½”ì¹˜:</strong> í›Œë¥­í•œ ì‘ì—…ì…ë‹ˆë‹¤! ëª‡ ê°€ì§€ ê´€ì°°ì‚¬í•­ì„ ê³µìœ ë“œë¦´ê²Œìš”. ğŸ’¡<br><br>
                    <strong>ê¸°ìˆ ì  ë¶„ì„:</strong><br>
                    â€¢ í˜„ì¬ ìŠ¤íƒ€ì¼: ${analysis.style || 'modern'}<br>
                    â€¢ í’ˆì§ˆ ìˆ˜ì¤€: ${analysis.quality || 'good'}<br><br>
                    <strong>ë‹¤ìŒ ë‹¨ê³„:</strong><br>
                    â€¢ ë‹¤ì–‘í•œ ê¸°ë²•ì„ ì‹¤í—˜í•´ë³´ì„¸ìš”<br>
                    â€¢ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ê³¼ ë¹„êµ ë¶„ì„í•´ë³´ëŠ” ê²ƒì„ ì¶”ì²œí•´ìš”
                </div>
            `;
            
            chatContainer.innerHTML += gptFeedback + claudeFeedback;
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // í•™ìŠµ ë°ì´í„° ì—…ë°ì´íŠ¸
            updateLearningData('feedback_received', analysis);
        }
        
        function generateTextCoachResponse(userInput, analysis) {
            const chatContainer = document.getElementById('chatContainer');
            
            const userMessage = `
                <div class="message user">
                    <strong>ë‚˜:</strong> ${userInput}
                </div>
            `;
            
            // ì£¼ì œë³„ ë§ì¶¤ ì‘ë‹µ
            let response = '';
            switch(analysis.topic) {
                case 'art':
                    response = 'ì•„íŠ¸ì— ëŒ€í•œ ì§ˆë¬¸ì´êµ°ìš”! ì°½ì˜ì ì¸ í‘œí˜„ì— ëŒ€í•´ í•¨ê»˜ ì´ì•¼ê¸°í•´ë´ìš”. ğŸ¨';
                    break;
                case 'color':
                    response = 'ìƒ‰ìƒ ì´ë¡ ì€ ì •ë§ í¥ë¯¸ë¡œìš´ ì£¼ì œì—ìš”! ìƒ‰ìƒì˜ ì‹¬ë¦¬ì  íš¨ê³¼ì™€ ì¡°í™”ì— ëŒ€í•´ ì•Œë ¤ë“œë¦´ê²Œìš”. ğŸŒˆ';
                    break;
                case 'improvement':
                    response = 'ê°œì„ í•˜ë ¤ëŠ” ì˜ì§€ê°€ í›Œë¥­í•´ìš”! êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ë¶€ë¶„ì„ ë°œì „ì‹œí‚¤ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? ğŸ“ˆ';
                    break;
                default:
                    response = 'í¥ë¯¸ë¡œìš´ ì§ˆë¬¸ì´ë„¤ìš”! ë” ìì„¸íˆ ì„¤ëª…í•´ì£¼ì‹œë©´ êµ¬ì²´ì ìœ¼ë¡œ ë„ì™€ë“œë¦´ê²Œìš”. ğŸ’­';
            }
            
            const aiResponse = `
                <div class="message ai">
                    <strong>ë©€í‹° ì½”ì¹˜:</strong> ${response}<br><br>
                    ë¶„ì„ ê²°ê³¼, ë‹¹ì‹ ì˜ ${analysis.intent === 'question' ? 'ê¶ê¸ˆì¦' : 'ìš”ì²­'}ì„ ì´í•´í–ˆì–´ìš”. 
                    ${analysis.emotion === 'positive' ? 'ê¸ì •ì ì¸ ì—ë„ˆì§€ê°€ ëŠê»´ì ¸ì„œ ì¢‹ë„¤ìš”! âœ¨' : 
                      analysis.emotion === 'negative' ? 'ì–´ë ¤ì›€ì´ ìˆìœ¼ì‹œêµ°ìš”. í•¨ê»˜ í•´ê²°í•´ë´ìš”! ğŸ’ª' : 
                      'ì°¨ê·¼ì°¨ê·¼ ë„ì›€ë“œë¦´ê²Œìš”! ğŸ¤'}
                </div>
            `;
            
            chatContainer.innerHTML += userMessage + aiResponse;
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
        
        function getCoachFeedback() {
            const userInput = document.getElementById('userInput').value;
            if (!userInput.trim()) {
                alert('ë¨¼ì € ì§ˆë¬¸ì´ë‚˜ ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            processInput();
            updateLearningData('coach_requested', userInput);
        }
        
        function sendChatMessage() {
            const chatInput = document.getElementById('chatInput');
            const message = chatInput.value.trim();
            if (!message) return;
            
            const chatContainer = document.getElementById('chatContainer');
            const userMessage = `
                <div class="message user">
                    <strong>ë‚˜:</strong> ${message}
                </div>
            `;
            
            chatContainer.innerHTML += userMessage;
            chatInput.value = '';
            
            // íƒ€ì´í•‘ í‘œì‹œ
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message ai typing-indicator';
            typingDiv.innerHTML = '<strong>AI ì½”ì¹˜ë“¤ì´ ìƒê° ì¤‘...</strong> ğŸ’­';
            chatContainer.appendChild(typingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // ì‘ë‹µ ìƒì„±
            setTimeout(() => {
                chatContainer.removeChild(typingDiv);
                
                const responses = [
                    `ì •ë§ ì¢‹ì€ ì§ˆë¬¸ì´ì—ìš”! "${message}"ì— ëŒ€í•´ í•¨ê»˜ ìƒê°í•´ë´ìš”. ì´ëŸ° ê´€ì ì—ì„œ ì ‘ê·¼í•´ë³´ëŠ” ê±´ ì–´ë–¨ê¹Œìš”? ğŸ¤”`,
                    `"${message}" - í¥ë¯¸ë¡œìš´ ì£¼ì œë„¤ìš”! ì œ ê²½í—˜ìƒ ì´ëŸ° ê²½ìš°ì—ëŠ” ë‹¨ê³„ë³„ë¡œ ì ‘ê·¼í•˜ëŠ” ê²ƒì´ íš¨ê³¼ì ì´ì—ìš”. ğŸ’¡`,
                    `í›Œë¥­í•œ ì•„ì´ë””ì–´ì…ë‹ˆë‹¤! "${message}"ë¥¼ ë” ë°œì „ì‹œí‚¤ë ¤ë©´ ì´ëŸ° ë°©ë²•ë“¤ì„ ì‹œë„í•´ë³´ì„¸ìš”. êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ë¶€ë¶„ì´ ê¶ê¸ˆí•˜ì‹ ê°€ìš”? ğŸš€`,
                    `"${message}" - ì´ ì£¼ì œì— ëŒ€í•´ ê¹Šì´ ìƒê°í•´ë³´ì…¨êµ°ìš”! ë‹¤ì–‘í•œ ê°ë„ì—ì„œ ë¶„ì„í•´ë³´ë©´ ìƒˆë¡œìš´ ì¸ì‚¬ì´íŠ¸ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. âœ¨`
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                
                const aiResponse = `
                    <div class="message ai">
                        <strong>GPT ì½”ì¹˜:</strong> ${randomResponse}
                    </div>
                    <div class="message coach">
                        <strong>Claude ì½”ì¹˜:</strong> ì¶”ê°€ë¡œ ë§ì”€ë“œë¦¬ë©´, ì´ëŸ° ìƒí™©ì—ì„œëŠ” ì‹¤ìŠµê³¼ ì´ë¡ ì„ ë³‘í–‰í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•´ìš”. ì§ì ‘ í•´ë³´ë©´ì„œ ë°°ìš°ëŠ” ê²½í—˜ì´ ê°€ì¥ ê°’ì§„ í•™ìŠµì´ ë©ë‹ˆë‹¤! ğŸ“š
                    </div>
                `;
                
                chatContainer.innerHTML += aiResponse;
                chatContainer.scrollTop = chatContainer.scrollHeight;
                
                updateLearningData('chat_interaction', message);
            }, 2000);
        }
        
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.coach-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.coach-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}Content`).classList.add('active');
            
            if (tabName === 'progress') {
                updateProgressDisplay();
            } else if (tabName === 'analysis') {
                updateHistoryDisplay();
            }
        }
        
        function updateLearningData(type, data) {
            learningData.sessions++;
            
            switch(type) {
                case 'feedback_received':
                    learningData.feedbacks.push({
                        timestamp: new Date(),
                        type: 'auto_analysis',
                        data: data
                    });
                    break;
                case 'coach_requested':
                    learningData.feedbacks.push({
                        timestamp: new Date(),
                        type: 'manual_request',
                        data: data
                    });
                    break;
                case 'chat_interaction':
                    learningData.feedbacks.push({
                        timestamp: new Date(),
                        type: 'chat',
                        data: data
                    });
                    break;
            }
            
            // í–¥ìƒë„ ê³„ì‚° (ì„¸ì…˜ ìˆ˜ì— ë”°ë¼ ì¦ê°€)
            const improvementScore = Math.min(95, Math.floor(learningData.sessions * 3.5));
            learningData.improvementScore = improvementScore;
            
            // ìŠ¤í‚¬ ë ˆë²¨ ì—…ë°ì´íŠ¸
            if (learningData.sessions > 20) {
                learningData.skillLevel = 'ê³ ê¸‰';
            } else if (learningData.sessions > 10) {
                learningData.skillLevel = 'ì¤‘ê¸‰';
            } else if (learningData.sessions > 5) {
                learningData.skillLevel = 'ì´ˆì¤‘ê¸‰';
            } else {
                learningData.skillLevel = 'ì´ˆê¸‰';
            }
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ìê°€ í•™ìŠµ ë°ì´í„° ë³´ì¡´)
            try {
                localStorage.setItem('learningData', JSON.stringify(learningData));
            } catch(e) {
                console.log('ë¡œì»¬ ì €ì¥ ì‹¤íŒ¨, ë©”ëª¨ë¦¬ì—ë§Œ ë³´ê´€');
            }
        }
        
        function updateProgressDisplay() {
            document.getElementById('sessionCount').textContent = learningData.sessions;
            document.getElementById('improvementScore').textContent = learningData.improvementScore + '%';
            document.getElementById('feedbackCount').textContent = learningData.feedbacks.length;
            document.getElementById('skillLevel').textContent = learningData.skillLevel;
            
            // ì§„ë„ ë°” ì—…ë°ì´íŠ¸
            const progressPercent = Math.min(100, learningData.sessions * 2);
            document.getElementById('overallProgress').style.width = progressPercent + '%';
            
            // ìŠ¤í‚¬ ì§„ë„ ì—…ë°ì´íŠ¸ (ëœë¤í•˜ê²Œ ë°œì „)
            if (learningData.sessions % 3 === 0) {
                Object.keys(learningData.skillProgress).forEach(skill => {
                    if (Math.random() > 0.7 && learningData.skillProgress[skill] < 5) {
                        learningData.skillProgress[skill]++;
                    }
                });
            }
        }
        
        function addToHistory(type, data) {
            learningData.analysisHistory.unshift({
                timestamp: new Date(),
                type: type,
                data: data
            });
            
            // ìµœëŒ€ 50ê°œ í•­ëª©ë§Œ ë³´ê´€
            if (learningData.analysisHistory.length > 50) {
                learningData.analysisHistory = learningData.analysisHistory.slice(0, 50);
            }
        }
        
        function updateHistoryDisplay() {
            const historyList = document.getElementById('historyList');
            
            if (learningData.analysisHistory.length === 0) {
                historyList.innerHTML = '<p>ì•„ì§ ë¶„ì„ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ì§ˆë¬¸ì„ í•´ë³´ì„¸ìš”!</p>';
                return;
            }
            
            historyList.innerHTML = learningData.analysisHistory.map((item, index) => {
                const timeStr = item.timestamp.toLocaleString();
                let content = '';
                
                switch(item.type) {
                    case 'image_analysis':
                        content = `ğŸ–¼ï¸ ì´ë¯¸ì§€ ë¶„ì„ - ìŠ¤íƒ€ì¼: ${item.data.style}, í’ˆì§ˆ: ${item.data.quality}`;
                        break;
                    case 'text_input':
                        content = `ğŸ’­ í…ìŠ¤íŠ¸ ë¶„ì„ - "${item.data.input.substring(0, 30)}..."`;
                        break;
                    case 'file_upload':
                        content = `ğŸ“ íŒŒì¼ ì—…ë¡œë“œ - ${item.data.name}`;
                        break;
                    default:
                        content = `ğŸ“ ê¸°íƒ€ í™œë™ - ${JSON.stringify(item.data).substring(0, 50)}...`;
                }
                
                return `
                    <div class="analysis-item">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span>${content}</span>
                            <small style="color: #666;">${timeStr}</small>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function clearWorkspace() {
            document.getElementById('userInput').value = '';
            document.getElementById('analysisResults').innerHTML = '';
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('fileInput').value = '';
        }
        
        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('learningData');
                if (savedData) {
                    const parsed = JSON.parse(savedData);
                    // ê¸°ì¡´ êµ¬ì¡°ì™€ ë³‘í•©
                    learningData = { ...learningData, ...parsed };
                    
                    // ë‚ ì§œ ê°ì²´ ë³µì›
                    learningData.feedbacks.forEach(feedback => {
                        feedback.timestamp = new Date(feedback.timestamp);
                    });
                    learningData.analysisHistory.forEach(item => {
                        item.timestamp = new Date(item.timestamp);
                    });
                }
            } catch(e) {
                console.log('ì €ì¥ëœ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨, ìƒˆë¡œ ì‹œì‘');
            }
        }
        
        // ìë™ í•™ìŠµ ë° ê°œì„  ì œì•ˆ
        function generateAutoImprovement() {
            const sessionCount = learningData.sessions;
            const recentActivities = learningData.analysisHistory.slice(0, 5);
            
            if (sessionCount > 0 && sessionCount % 5 === 0) {
                const chatContainer = document.getElementById('chatContainer');
                
                const autoSuggestion = `
                    <div class="message coach">
                        <strong>ğŸ¤– ìë™ í•™ìŠµ ë¶„ì„:</strong> ${sessionCount}ë²ˆì˜ ì„¸ì…˜ì„ ì™„ë£Œí•˜ì…¨ë„¤ìš”! ğŸ‰<br><br>
                        <strong>ë°œê²¬ëœ íŒ¨í„´:</strong><br>
                        â€¢ ì£¼ë¡œ ${getMainActivityType()}ì— ê´€ì‹¬ì´ ë§ìœ¼ì‹œêµ°ìš”<br>
                        â€¢ í•™ìŠµ ì†ë„ê°€ ${getLearningSpeed()}ì…ë‹ˆë‹¤<br><br>
                        <strong>ë‹¤ìŒ ë‹¨ê³„ ì œì•ˆ:</strong><br>
                        â€¢ ${getNextStepSuggestion()}<br>
                        â€¢ ìƒˆë¡œìš´ ë„ì „ì„ ì‹œë„í•´ë³´ì„¸ìš”!
                    </div>
                `;
                
                chatContainer.innerHTML += autoSuggestion;
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
        }
        
        function getMainActivityType() {
            const types = learningData.analysisHistory.map(item => item.type);
            const counts = {};
            types.forEach(type => counts[type] = (counts[type] || 0) + 1);
            
            const main = Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b, 'general');
            
            switch(main) {
                case 'image_analysis': return 'ì´ë¯¸ì§€ ë¶„ì„';
                case 'text_input': return 'í…ìŠ¤íŠ¸ ì§ˆë¬¸';
                case 'file_upload': return 'íŒŒì¼ ì‘ì—…';
                default: return 'ì¢…í•©ì ì¸ í•™ìŠµ';
            }
        }
        
        function getLearningSpeed() {
            const speed = learningData.sessions / Math.max(1, learningData.analysisHistory.length);
            return speed > 0.8 ? 'ë§¤ìš° ë¹ ë¦„ ğŸš€' : speed > 0.5 ? 'ë³´í†µ ğŸ“ˆ' : 'ì‹ ì¤‘í•¨ ğŸ¤”';
        }
        
        function getNextStepSuggestion() {
            const suggestions = [
                'ë” ë³µì¡í•œ í”„ë¡œì íŠ¸ì— ë„ì „í•´ë³´ì„¸ìš”',
                'ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ì´ë‚˜ ê¸°ë²•ì„ ì‹¤í—˜í•´ë³´ì„¸ìš”',
                'í˜‘ì—… í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”',
                'í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì •ë¦¬í•´ë³´ì„¸ìš”',
                'ìƒˆë¡œìš´ ë„êµ¬ë‚˜ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë°°ì›Œë³´ì„¸ìš”'
            ];
            
            return suggestions[Math.floor(Math.random() * suggestions.length)];
        }
        
        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                processInput();
            } else if (e.key === 'Enter' && e.target.id === 'chatInput') {
                sendChatMessage();
            }
        });
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', function() {
            setupFileUpload();
            initSpeechRecognition();
            loadSavedData();
            
            // í™˜ì˜ ë©”ì‹œì§€ì™€ í•¨ê»˜ ì‹œì‘
            setTimeout(() => {
                updateProgressDisplay();
                
                // ì •ê¸°ì ìœ¼ë¡œ ìë™ ê°œì„  ì œì•ˆ
                setInterval(generateAutoImprovement, 30000); // 30ì´ˆë§ˆë‹¤ ì²´í¬
            }, 1000);
        });
        
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.getElementById('voiceBtn').addEventListener('click', toggleVoice);
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                processInput();
            }
        });
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendChatMessage();
            }
        });
    </script>
</body>
</html>
